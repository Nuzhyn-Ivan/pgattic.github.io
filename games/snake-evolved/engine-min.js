var mapSize=1e3,turnSensitivity=.1,playerSpeed=2,amtOfFood=100,sprintingAtrophy=.5,playerSizeFloor=150,mouthSize=10,growthRate=20,foodDropConstant=30;function rotatePlayer(e){players[e].left&&(players[e].direction+=turnSensitivity),players[e].right&&(players[e].direction-=turnSensitivity)}function movePlayer(e){var a=Math.cos(players[e].direction)*playerSpeed,o=Math.sin(players[e].direction)*playerSpeed;for(players[e].location.unshift([players[e].location[0][0]+a,players[e].location[0][1]-o]),players[e].location.length>players[e].size&&players[e].location.pop();players[e].location.length>players[e].size;)players[e].location.pop()}function spawnFood(){if(food.length<amtOfFood){var e=Math.random()*Math.PI*2,a=Math.random()*mapSize,o=Math.cos(e)*a,t=Math.sin(e)*a;food.push([o,t])}}function killPlayer(e){Math.sqrt(Math.pow(players[e].location[0][0],2)+Math.pow(players[e].location[0][1],2))>mapSize&&doKill(e);for(var a=0;a<numOfPlayers;a++)if(a!=e)for(var o=0;o<players[a].location.length;o++){var t=players[e].location[0][0]-players[a].location[o][0],r=players[e].location[0][1]-players[a].location[o][1];Math.sqrt(Math.pow(t,2)+Math.pow(r,2))<mouthSize&&doKill(e)}}function doKill(e){for(var a=0;a<players[e].location.length;a++)a%foodDropConstant==0&&food.push([players[e].location[a][0],players[e].location[a][1]]);players[e].location=[startLocation[e]],players[e].direction=startDirection[e],players[e].size=startLength,scoreMeters[e].innerHTML="Score: "+players[e].size}function eatFood(e){for(var a=0;a<food.length;a++){var o=players[e].location[0][0]-food[a][0],t=players[e].location[0][1]-food[a][1];Math.sqrt(Math.pow(o,2)+Math.pow(t,2))<mouthSize&&(food.splice(a,1),players[e].size+=growthRate,scoreMeters[e].innerHTML="Score: "+players[e].size)}}function calculate(){for(var e=0;e<numOfPlayers;e++)rotatePlayer(e),movePlayer(e),players[e].up&&players[e].size>playerSizeFloor?(players[e].boosting=!0,movePlayer(e),players[e].size-=sprintingAtrophy,scoreMeters[e].innerHTML="Score: "+players[e].size):players[e].boosting=!1,killPlayer(e),eatFood(e);spawnFood()}function drawBG(e){ctx[e].beginPath(),ctx[e].arc(0,0,mapSize,0,2*Math.PI),ctx[e].fillStyle="white",ctx[e].fill(),ctx[e].closePath()}function drawPlayer(e){for(var a=0;a<numOfPlayers;a++){ctx[e].lineCap="round",ctx[e].lineWidth=10,ctx[e].beginPath(),ctx[e].moveTo(players[a].location[0][0],players[a].location[0][1]);for(var o=0;o<players[a].location.length;o++)ctx[e].lineTo(players[a].location[o][0],players[a].location[o][1]);ctx[e].strokeStyle=players[a].boosting?players[a].boostColor:players[a].color,ctx[e].stroke(),ctx[e].closePath()}ctx[e].font="16px Arial",ctx[e].fillStyle="black",ctx[e].textAlign="center",ctx[e].fillText("â–²",players[e].location[0][0],players[e].location[0][1]-10)}function drawFood(e){for(var a=0;a<food.length;a++)ctx[e].beginPath(),ctx[e].arc(food[a][0],food[a][1],5,0,2*Math.PI),ctx[e].fillStyle="green",ctx[e].fill(),ctx[e].closePath()}function translateCanvas(e){ctx[e].restore(),ctx[e].save(),ctx[e].translate(canvas[e].width/2,canvas[e].height/2),ctx[e].rotate(players[e].direction-Math.PI/2),ctx[e].translate(-players[e].location[0][0],-players[e].location[0][1])}function draw(){for(var e=0;e<numOfPlayers;e++)ctx[e].clearRect(-mapSize-1e3,-mapSize-1e3,2*mapSize+2e3,2*mapSize+2e3),drawBG(e),drawPlayer(e),drawFood(e),translateCanvas(e)}function main(){paused||calculate(),draw(),requestAnimationFrame(main)}paused=!1,food=[],/Android|webOS|iPhone|iPad|iPod|BlackBerry|BB|PlayBook|IEMobile|Windows Phone|Kindle|Silk|Opera Mini/i.test(navigator.userAgent)&&alert("Are you on mobile? This game was created for PC users only, sorry!"),window.onresize=function(){resize()},resize(),onkeydown=function(){for(var e=0;e<numOfPlayers;e++)switch(event.key){case players[e].upKey:players[e].up=!0;break;case players[e].leftKey:players[e].left=!0;break;case players[e].rightKey:players[e].right=!0}if("Escape"==event.key){paused=!paused,document.getElementById("paused").style.display=paused?"block":"none";for(var a=0;a<canvas.length;a++)canvas[a].style.filter=paused?"blur(1px)":"blur(0)"}},onkeyup=function(){for(var e=0;e<numOfPlayers;e++)switch(event.key){case players[e].upKey:players[e].up=!1;break;case players[e].leftKey:players[e].left=!1;break;case players[e].rightKey:players[e].right=!1}},requestAnimationFrame(main);